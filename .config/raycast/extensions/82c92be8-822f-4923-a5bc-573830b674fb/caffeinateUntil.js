"use strict";var d=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var I=Object.prototype.hasOwnProperty;var k=(t,e)=>{for(var n in e)d(t,n,{get:e[n],enumerable:!0})},L=(t,e,n,u)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of T(e))!I.call(t,s)&&s!==n&&d(t,s,{get:()=>e[s],enumerable:!(u=C(e,s))||u.enumerable});return t};var U=t=>L(d({},"__esModule",{value:!0}),t);var N={};k(N,{default:()=>w});module.exports=U(N);var i=require("@raycast/api");var a=require("@raycast/api"),c=require("node:child_process");async function p(t,e,n){e&&await(0,a.showHUD)(e),await $({menubar:!1,status:!1}),(0,c.exec)(`/usr/bin/caffeinate ${v(n)} || true`),await S(t,!0)}async function $(t,e){e&&await(0,a.showHUD)(e),(0,c.execSync)("/usr/bin/killall caffeinate || true"),await S(t,!1)}async function S(t,e){t.menubar&&await g("index",{caffeinated:e}),t.status&&await g("status",{caffeinated:e})}async function g(t,e){try{await(0,a.launchCommand)({name:t,type:a.LaunchType.Background,context:e})}catch{}}function v(t){let e=(0,a.getPreferenceValues)(),n=[];return e.preventDisplay&&n.push("d"),e.preventDisk&&n.push("m"),e.preventSystem&&n.push("i"),t&&n.push(` ${t}`),n.length>0?`-${n.join("")}`:""}async function w(t){let{time:e}=t.arguments,n=/^(\d{1,2})(?::(\d\d))? *(am|pm)?$/i;if(!n.test(e)){await(0,i.showToast)(i.Toast.Style.Failure,"Unrecognized time format");return}let[,u,s,f]=n.exec(e)??[],m=Number(u),o=m;f?.toLowerCase()=="pm"&&m<12&&(o+=12),f?.toLowerCase()=="am"&&m==12&&(o=0);let l=s?Number(s):0;if(o<0||o>24||l<0||l>59){await(0,i.showToast)(i.Toast.Style.Failure,"Unrecognized time format");return}let y=new Date,r=new Date;r.setHours(o),r.setMinutes(l),r.setSeconds(0);let D=f||o>12||u.startsWith("0");for(;r<=y;)r.setHours(r.getHours()+(D?24:12));let b=(r.getTime()-y.getTime())/1e3,h=r.toLocaleTimeString([],{timeStyle:"short"}),x=r.getDate()!=y.getDate()?"tomorrow at ":"";await p({menubar:!0,status:!0},`Caffeinating your Mac until ${x}${h}`,`-t ${b}`)}
